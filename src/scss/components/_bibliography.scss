//
// Bibliography
//

.bibliography {
	padding: 0;
	list-style: none;
	text-align: left;

	.write & {
		margin: $space-lg (-$grid-gutter-width / 2);

		@media (min-width: $bp-md) {
			margin: $space-lg 0;
		}

		.citation {
			display: flex;
			align-items: center;
			padding: ($space-lg - 7px) ($space-md - $space-xs) ($space-lg - 7px) $space-md; // Caps height
			border-top: 1px solid $shade-2;
			cursor: pointer;
			position: relative;

			@media (max-width: $bp-md - 1px) {
				padding-right: $space-md - 2px;
			}

			@media (min-width: $bp-md) {
				&::before {
					content: "";
					position: absolute;
					left: 100%;
					width: 36px;
					height: 100%;
				}
			}

			&:last-child {
				border-bottom: 1px solid $shade-2;
			}

			&:hover {
				background-color: $shade-1;

				@media (min-width: $bp-md) {
					.btn-remove {
						opacity: 1;
					}
				}
			}

			&:focus {
				@at-root #{selector-replace(&, ".write", ".write.keyboard-user")} {
					outline-offset: -3px;

					& + .citation {
						border-top-color: transparent;
					}
				}
			}

			.csl-entry-container {
				flex: 1 1 0;
				margin-right: ($space-md - $space-xs);
				min-width: 0; // Enable word-wrap for long URLs
			}

			> .btn-icon,
			.dropdown {
				margin-top: -$space-lg;
				margin-bottom: -$space-lg;
			}

			> .btn-icon {
				flex: 0 0 auto;
				transition: opacity $btn-transition;

				&.success {
					background: $btn-success-color;

					.icon-copy {
						display: none;
					}

					.icon-tick {
						display: block;
					}
				}
			}

			.btn-copy {
				@include button-variant($btn-secondary-color, $outline: true);
				border-color: transparent;

				&:focus {
					@at-root #{selector-replace(&, ".write", ".write.keyboard-user")} {
						border-color: $btn-secondary-color;
					}
				}

				&:active {
					.icon {
						color: $shade-0;
					}
				}
			}

			.btn-remove {
				position: absolute;
				width: 20px;
				height: 20px;
				top: 50%;
				right: -28px;
				margin: -10px 0 0 0;
				border-radius: 50%;
				display: none;

				@include button-variant($btn-secondary-color, $outline: true);

				&:active {
					opacity: 1;
				}

				@media (min-width: $bp-md) {
					display: block;
					opacity: 0;

					&:focus {
						@at-root #{selector-replace(&, ".write", ".write.keyboard-user")} {
							opacity: 1;
							box-shadow: 0 0 0 $input-btn-focus-width $btn-secondary-color;

							.icon {
								color: $btn-secondary-color;
							}

							&:hover {
								box-shadow:
									0 0 0 $input-btn-focus-width $btn-secondary-color,
									0 4px 4px $btn-box-shadow-color;
							}

							&:active {
								box-shadow: 0 0 0 $input-btn-focus-width darken($btn-secondary-color, 8%);
							}
						}
					}
				}
			}

			.icon-tick {
				display: none;
				color: $shade-0;
			}
		}
	}

	.read-only & {
		font-size: 18px;
		margin-bottom: $space-xl - 7px;

		@media (min-width: $bp-md) {
			margin-bottom: $space-xxl - 7px;
		}
	}
}
